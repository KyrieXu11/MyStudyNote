# 运行时数据区

![jvm_Struct.png](https://i.loli.net/2020/03/19/YbXZrBxU67gL9JQ.png)

方法区和堆是线程共享的，其他的都是线程独占的

## 栈

### java虚拟机栈

虚拟机栈是每个方法执行的时候，都会创建一个栈帧用来存储同步变量表、操作数栈、动态连接、方法出口等信息

局部变量表存放了编译期可知的各种Java虚拟机**基本数据类型**（boolean、byte、char、short、int、
float、long、double）、**对象引用**（reference类型，它并不等同于对象本身，可能是一个指向对象起始
地址的引用指针，也可能是指向一个代表对象的句柄或者其他与此对象相关的位置）和 **return Address**
类型（**指向了一条字节码指令的地址**）。











# 引用

## 强引用

即通过Object obj = new Object();方式创建出来的对象是强引用的，无论什么情况下，只要强引用关系存在，那么久不会回收掉这个对象。

## 软引用

软引用是指那些还有用但是非必须的对象，这些对象会在发生OOM错误之前被回收。在jdk1.2之后，提供了`softReference`类来实现软引用

## 弱引用

弱引用是指那些非必须的对象，引用强度比软引用要低一些，所以只要发生垃圾回收，弱引用对象都会被回收。

## 虚引用

无法通过虚引用来获取对象，为这个对象设置虚引用的目的只是为了能够在垃圾回收的时候收到回收的消息。

# 方法区垃圾回收

## 废弃的常量

程序中没有对象引用常量池的常量的时候，会将其回收

## 不再使用的类型

必须满足一下三个条件：

+ 该类的所有实例都被回收，包括派生类的对象以及本类的对象都不在堆中出现。
+ 加载该类的类加载器被回收
+ 程序中没有该类的class对象的引用，即无法通过反射来获取该类的信息

